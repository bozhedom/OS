# Лабораторная работа: Кроссплатформенная программа для мониторинга температуры с логированием

## Описание задачи

Есть устройство, которое публикует данные о текущей температуре окружающей среды через серийный порт или интерфейс USB. Необходимо разработать кроссплатформенную программу на языке C/C++, которая будет:

1. Считывать температуру с устройства через серийный порт.
2. Записывать данные в лог-файл с измерениями температуры.
3. Каждые 60 минут вычислять среднюю температуру за последний час и записывать её в отдельный лог-файл.
4. Каждые 1440 минут (один день) вычислять среднюю температуру за день и записывать её в третий лог-файл.
5. Лог-файлы должны иметь ограничения по времени хранения:
   - Лог-файл с измерениями температуры хранит только данные за последние 24 часа.
   - Лог-файл с часовой средней температурой хранит только данные за последний месяц.
   - Лог-файл с дневной средней температурой накапливает данные за текущий год.
6. Для проверки работы программы предусмотрена возможность либо получения устройства с указанным функционалом, либо симуляции работы устройства с помощью специально созданной программы.

## Основные функции программы

1. **Считывание температуры с устройства**:
   - Программа должна читать данные с устройства, подключенного через серийный порт или интерфейс USB.
   - В случае, если устройство недоступно, программа использует симуляцию температуры в диапазоне от -10 до 35 градусов Цельсия.

2. **Запись данных в лог-файлы**:
   - Программа записывает каждое измерение температуры в лог-файл с полными данными за последний день.
   - В отдельные лог-файлы записываются средние значения температуры за каждый час и каждый день.

3. **Обработка лог-файлов**:
   - Лог-файл с измерениями температуры сохраняет данные только за последние 24 часа.
   - Лог-файл с часовой средней температурой сохраняет данные за последний месяц.
   - Лог-файл с дневной средней температурой сохраняет данные за текущий год.

4. **Работа с серийным портом**:
   - Программа должна работать как в Windows, так и в Linux, поддерживая стандартный интерфейс серийного порта (COM или /dev/ttyUSB).

## Структура программы

- **readTemperatureFromSerial(const std::string& portName)**: Читает данные температуры с устройства через серийный порт.
- **simulateDeviceTemperature()**: Симулирует показания температуры в случае недоступности устройства.
- **getCurrentTime()**: Возвращает текущее время в формате "YYYY-MM-DD HH:MM:SS".
- **getCurrentDate()**: Возвращает текущую дату в формате "YYYY-MM-DD".
- **writeLog(const std::string& filePath, const std::string& message)**: Записывает строку в указанный лог-файл.
- **logHourlyAverage(const std::vector<float>& temperatures, const std::string& filePath)**: Рассчитывает среднее значение температуры за последний час и записывает его в лог.
- **logDailyAverage(const std::vector<float>& temperatures, const std::string& filePath)**: Рассчитывает среднее значение температуры за сутки и записывает его в лог.
- **cleanOldData(const std::string& filePath, int hoursLimit)**: Удаляет старые данные из лог-файлов.

## Сценарии работы программы

1. **Чтение температуры с устройства**:
   - Программа подключается к порту и считывает данные о температуре с устройства.
   - В случае отсутствия устройства или ошибки чтения, программа использует симуляцию для генерации случайных данных температуры.

2. **Запись в лог**:
   - Программа записывает данные температуры в лог-файл `all_measurements.log` для каждого измерения.
   - Каждые 60 минут программа записывает среднюю температуру за последний час в лог-файл `hourly_average.log`.
   - Каждый день программа записывает среднюю температуру за сутки в лог-файл `daily_average.log`.

3. **Обработка старых данных**:
   - Лог-файл `all_measurements.log` хранит данные только за последние 24 часа.
   - Лог-файл `hourly_average.log` хранит данные только за последний месяц.
   - Лог-файл `daily_average.log` накапливает данные за текущий год.

4. **Запуск программы**:
   - Программа запускается в цикле и выполняет считывание температуры каждую минуту, а также выполняет другие вычисления и записи в лог-файлы.

## Логирование

Программа записывает данные в следующие файлы:

- **all_measurements.log**: Лог-файл с полными измерениями температуры.
- **hourly_average.log**: Лог-файл с часовой средней температурой.
- **daily_average.log**: Лог-файл с дневной средней температурой.

---

## Инструкция:

### Для Windows:

1. Запустить сборку проекта:
   ```cmd
   build.cmd
   ```
2. Выполнить программу:
   ```cmd
   build\EnvTempMonitor.exe
   ```

### Для Linux:

1. Запустить сборку проекта:
   ```bash
   build.sh
   ```
2. Выполнить программу:
   ```bash
   build\EnvTempMonitor
   ```

---